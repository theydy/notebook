<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>javascript åŸºç¡€ | theydy</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/notebook/icon.png">
    <meta name="description" content="theydy çš„ä¸ªäººåšå®¢">
    
    <link rel="preload" href="/notebook/assets/css/0.styles.254e6a27.css" as="style"><link rel="preload" href="/notebook/assets/js/app.af3d77a2.js" as="script"><link rel="preload" href="/notebook/assets/js/2.b500958f.js" as="script"><link rel="preload" href="/notebook/assets/js/15.0a87671a.js" as="script"><link rel="prefetch" href="/notebook/assets/js/10.b947421a.js"><link rel="prefetch" href="/notebook/assets/js/11.a38fea1d.js"><link rel="prefetch" href="/notebook/assets/js/12.4abdda40.js"><link rel="prefetch" href="/notebook/assets/js/13.ff9ec673.js"><link rel="prefetch" href="/notebook/assets/js/14.161acf6f.js"><link rel="prefetch" href="/notebook/assets/js/16.d090c71e.js"><link rel="prefetch" href="/notebook/assets/js/17.0e7f48ef.js"><link rel="prefetch" href="/notebook/assets/js/18.fea93345.js"><link rel="prefetch" href="/notebook/assets/js/19.40d3b0c7.js"><link rel="prefetch" href="/notebook/assets/js/20.69bfd485.js"><link rel="prefetch" href="/notebook/assets/js/21.412c6f26.js"><link rel="prefetch" href="/notebook/assets/js/22.90e690bd.js"><link rel="prefetch" href="/notebook/assets/js/23.ae42788f.js"><link rel="prefetch" href="/notebook/assets/js/24.ee56036e.js"><link rel="prefetch" href="/notebook/assets/js/25.32abe170.js"><link rel="prefetch" href="/notebook/assets/js/26.d51d4606.js"><link rel="prefetch" href="/notebook/assets/js/3.456b17e1.js"><link rel="prefetch" href="/notebook/assets/js/4.779e3c9b.js"><link rel="prefetch" href="/notebook/assets/js/5.5b45f7ce.js"><link rel="prefetch" href="/notebook/assets/js/6.51386bfb.js"><link rel="prefetch" href="/notebook/assets/js/7.22950914.js"><link rel="prefetch" href="/notebook/assets/js/8.edafac0c.js"><link rel="prefetch" href="/notebook/assets/js/9.3738fea4.js">
    <link rel="stylesheet" href="/notebook/assets/css/0.styles.254e6a27.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/notebook/" class="home-link router-link-active"><!----> <span class="site-name">theydy</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/notebook/interview/js.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  å‰ç«¯é¢è¯•
</a></div><div class="nav-item"><a href="/notebook/vue/" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/notebook/react/" class="nav-link">
  React
</a></div><div class="nav-item"><a href="/notebook/webpack/" class="nav-link">
  Webpack
</a></div><div class="nav-item"><a href="/notebook/other/tools.html" class="nav-link">
  æ‚ä¸ƒæ‚å…«
</a></div> <a href="https://github.com/theydy/notebook" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/notebook/interview/js.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  å‰ç«¯é¢è¯•
</a></div><div class="nav-item"><a href="/notebook/vue/" class="nav-link">
  Vue
</a></div><div class="nav-item"><a href="/notebook/react/" class="nav-link">
  React
</a></div><div class="nav-item"><a href="/notebook/webpack/" class="nav-link">
  Webpack
</a></div><div class="nav-item"><a href="/notebook/other/tools.html" class="nav-link">
  æ‚ä¸ƒæ‚å…«
</a></div> <a href="https://github.com/theydy/notebook" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>å‰ç«¯é¢è¯•</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/notebook/interview/js.html" aria-current="page" class="active sidebar-link">javascript åŸºç¡€</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/notebook/interview/js.html#åŸå‹-åŸå‹é“¾" class="sidebar-link">åŸå‹ / åŸå‹é“¾</a></li><li class="sidebar-sub-header"><a href="/notebook/interview/js.html#ç»§æ‰¿" class="sidebar-link">ç»§æ‰¿</a></li><li class="sidebar-sub-header"><a href="/notebook/interview/js.html#ä½œç”¨åŸŸé“¾" class="sidebar-link">ä½œç”¨åŸŸé“¾</a></li><li class="sidebar-sub-header"><a href="/notebook/interview/js.html#é—­åŒ…" class="sidebar-link">é—­åŒ…</a></li><li class="sidebar-sub-header"><a href="/notebook/interview/js.html#this-æŒ‡å‘" class="sidebar-link">this æŒ‡å‘</a></li><li class="sidebar-sub-header"><a href="/notebook/interview/js.html#å˜é‡æå‡" class="sidebar-link">å˜é‡æå‡</a></li><li class="sidebar-sub-header"><a href="/notebook/interview/js.html#event-loop" class="sidebar-link">event loop</a></li><li class="sidebar-sub-header"><a href="/notebook/interview/js.html#promise" class="sidebar-link">promise</a></li><li class="sidebar-sub-header"><a href="/notebook/interview/js.html#generator" class="sidebar-link">generator</a></li></ul></li><li><a href="/notebook/interview/css.html" class="sidebar-link">css</a></li><li><a href="/notebook/interview/code.html" class="sidebar-link">å„ç§æ‰‹å†™é¢˜</a></li><li><a href="/notebook/interview/browser.html" class="sidebar-link">æµè§ˆå™¨ç›¸å…³</a></li><li><a href="/notebook/interview/http.html" class="sidebar-link">HTTP ç›¸å…³</a></li><li><a href="/notebook/interview/vue.html" class="sidebar-link">vue é¢è¯•é¢˜</a></li><li><a href="/notebook/interview/safety.html" class="sidebar-link">å‰ç«¯å®‰å…¨</a></li><li><a href="/notebook/interview/webpack.html" class="sidebar-link">webpack</a></li><li><a href="/notebook/interview/optimization.html" class="sidebar-link">æ€§èƒ½ä¼˜åŒ–</a></li><li><a href="/notebook/interview/algorithm.html" class="sidebar-link">ç®—æ³•</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="javascript-åŸºç¡€"><a href="#javascript-åŸºç¡€" class="header-anchor">#</a> javascript åŸºç¡€</h1> <h2 id="åŸå‹-åŸå‹é“¾"><a href="#åŸå‹-åŸå‹é“¾" class="header-anchor">#</a> åŸå‹ / åŸå‹é“¾</h2> <h3 id="prototype"><a href="#prototype" class="header-anchor">#</a> prototype</h3> <p>æ¯ä¸ªå‡½æ•°éƒ½æœ‰ä¸€ä¸ª <code>prototype</code> å±æ€§ã€‚</p> <p><strong>è¿™ä¸ª <code>prototype</code> å±æ€§æŒ‡å‘çš„æ˜¯ä½¿ç”¨è¯¥å‡½æ•°åšä¸ºæ„é€ å‡½æ•°ç”Ÿæˆå¯¹è±¡çš„åŸå‹ã€‚</strong></p> <p>ğŸŒ°ï¼š</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">const</span> a <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

a<span class="token punctuation">.</span>__proto__ <span class="token operator">===</span> <span class="token class-name">A</span><span class="token punctuation">.</span>prototype <span class="token comment">// true</span>
</code></pre></div><p>è¿™é‡Œå¼•å‡ºå¦ä¸€æ¡åŸå‹é“¾çš„æŒ‡å‘è§„å¾‹ï¼š<strong>å¯¹äºæ¯ä¸ªæ™®é€šå¯¹è±¡æ¥è¯´ï¼Œéƒ½æœ‰ä¸€ä¸ª <code>__proto__</code> æŒ‡å‘å®ƒçš„åŸå‹ã€‚</strong></p> <p>å¯¹äºå‡½æ•°æ¥è¯´ï¼Œæ—¢æœ‰ <code>prototype</code> åˆæœ‰ <code>__proto__</code> ã€‚</p> <h3 id="constructor"><a href="#constructor" class="header-anchor">#</a> constructor</h3> <p><strong>æ¯ä¸ªåŸå‹éƒ½æœ‰ä¸€ä¸ª constructor å±æ€§æŒ‡å‘å…³è”çš„æ„é€ å‡½æ•°ã€‚</strong></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token constant">A</span> <span class="token operator">===</span> <span class="token class-name">A</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token comment">// true</span>
</code></pre></div><p>ç»¼ä¸Šæ‰€è¿°ï¼Œå¦‚æœè¦æ‰‹åŠ¨æŒ‡å®šä¸€ä¸ªæ„é€ å‡½æ•°çš„åŸå‹é“¾çš„è¯ï¼Œåº”è¯¥è¿™æ ·æŒ‡å®šã€‚è¿™å°±æ˜¯åŸå‹é“¾ç»§æ‰¿ã€‚</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

<span class="token keyword">const</span> origin <span class="token operator">=</span> <span class="token punctuation">{</span> origin<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>

origin<span class="token punctuation">.</span>constructor <span class="token operator">=</span> <span class="token constant">A</span><span class="token punctuation">;</span>
<span class="token class-name">A</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> origin<span class="token punctuation">;</span>
</code></pre></div><h3 id="åŸå‹é“¾"><a href="#åŸå‹é“¾" class="header-anchor">#</a> åŸå‹é“¾</h3> <p>å½“è¯»å–å¯¹è±¡çš„å±æ€§æ—¶ï¼Œå¦‚æœæ‰¾ä¸åˆ°ï¼Œå°±ä¼šæŸ¥æ‰¾ä¸å¯¹è±¡å…³è”çš„åŸå‹ä¸­çš„å±æ€§ï¼Œå¦‚æœè¿˜æŸ¥ä¸åˆ°ï¼Œå°±å»æ‰¾åŸå‹çš„åŸå‹ï¼Œä¸€ç›´æ‰¾åˆ°æœ€é¡¶å±‚ä¸ºæ­¢ã€‚</p> <p>æœ€é¡¶å±‚å³ï¼š<code>Object.prototype.__proto__ === null</code></p> <p>å¯¹è±¡é€šè¿‡ <code>__proto__</code> å±æ€§ä¸åŸå‹å¯¹è±¡è¿æ¥ï¼Œç›´åˆ° <code>null</code> çš„è¿™æ¡é“¾çŠ¶ç»“æ„å°±æ˜¯åŸå‹é“¾ã€‚</p> <h3 id="proto"><a href="#proto" class="header-anchor">#</a> <strong>proto</strong></h3> <p><strong>proto</strong> å¹¶ä¸å­˜åœ¨äºåŸå‹ä¸Šï¼Œå®é™…ä¸Šï¼Œå®ƒæ˜¯æ¥è‡ªäº Object.prototype ï¼Œä¸å…¶è¯´æ˜¯ä¸€ä¸ªå±æ€§ï¼Œä¸å¦‚è¯´æ˜¯ä¸€ä¸ª getter/setterï¼Œå½“ä½¿ç”¨ obj.<strong>proto</strong> æ—¶ï¼Œå¯ä»¥ç†è§£æˆè¿”å›äº† <code>Object.getPrototypeOf(obj)</code>ã€‚</p> <h2 id="ç»§æ‰¿"><a href="#ç»§æ‰¿" class="header-anchor">#</a> ç»§æ‰¿</h2> <h3 id="es5-çš„ç»§æ‰¿"><a href="#es5-çš„ç»§æ‰¿" class="header-anchor">#</a> es5 çš„ç»§æ‰¿</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 1. åŸå‹ç»§æ‰¿</span>
<span class="token comment">// ä¼˜ï¼šå¯ä»¥ç»§æ‰¿çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•</span>
<span class="token comment">// ç¼ºï¼šçˆ¶ç±»å±æ€§å¦‚æœæ˜¯å¼•ç”¨ç±»å‹ï¼Œä¼šè¢«æ‰€æœ‰å­ç±»å…±ç”¨ï¼›åˆ›å»ºå­ç±»æ—¶ï¼Œæ— æ³•å‘çˆ¶ç±»ä¼ å‚</span>
<span class="token keyword">function</span> <span class="token function">prototypeExtend</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token constant">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token class-name">B</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">B</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> <span class="token constant">B</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 2. æ„é€ å‡½æ•°ç»§æ‰¿</span>
<span class="token comment">// ä¼˜ï¼šé¿å…äº†åŸå‹é“¾ç»§æ‰¿çš„ç¼ºç‚¹</span>
<span class="token comment">// ç¼ºï¼šåªç»§æ‰¿çˆ¶ç±»åœ¨æ„é€ å‡½æ•°ä¸­çš„å±æ€§æ–¹æ³•ï¼Œæ— æ³•ç»§æ‰¿åŸå‹ä¸Šçš„å±æ€§æ–¹æ³•</span>
<span class="token keyword">function</span> <span class="token function">constructorExtend</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token constant">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token constant">A</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 3. ç»„åˆç»§æ‰¿</span>
<span class="token comment">//ç¼ºï¼šæ‰§è¡Œäº†ä¸¤æ¬¡çˆ¶ç±»çš„æ„é€ å‡½æ•°ï¼Œå­ç±»åŸå‹ä¸Šä¼šæœ‰å¤šä½™çš„çˆ¶ç±»å±æ€§</span>
<span class="token keyword">function</span> <span class="token function">combinationExtend</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token constant">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token constant">A</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token class-name">B</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">B</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> <span class="token constant">B</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 4. å¯„ç”Ÿç»„åˆç»§æ‰¿</span>
<span class="token keyword">function</span> <span class="token function">extend</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">function</span> <span class="token constant">A</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token keyword">function</span> <span class="token constant">B</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token constant">A</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token class-name">B</span><span class="token punctuation">.</span>prototype <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token class-name">A</span><span class="token punctuation">.</span>prototype<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token class-name">B</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>constructor <span class="token operator">=</span> <span class="token constant">B</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="es5-ä¸-es6-class-ç»§æ‰¿çš„ä¸åŒ"><a href="#es5-ä¸-es6-class-ç»§æ‰¿çš„ä¸åŒ" class="header-anchor">#</a> es5 ä¸ es6 class ç»§æ‰¿çš„ä¸åŒ</h3> <h2 id="ä½œç”¨åŸŸé“¾"><a href="#ä½œç”¨åŸŸé“¾" class="header-anchor">#</a> ä½œç”¨åŸŸé“¾</h2> <p>å½“ JavaScript ä»£ç æ‰§è¡Œä¸€æ®µå¯æ‰§è¡Œä»£ç (executable code)æ—¶ï¼Œä¼šåˆ›å»ºå¯¹åº”çš„æ‰§è¡Œä¸Šä¸‹æ–‡(execution context)ã€‚</p> <p>å¯¹äºæ¯ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œéƒ½æœ‰ä¸‰ä¸ªé‡è¦å±æ€§ï¼š</p> <ul><li>å˜é‡å¯¹è±¡(Variable objectï¼ŒVO)</li> <li>ä½œç”¨åŸŸé“¾(Scope chain)</li> <li>this</li></ul> <p>å½“æŸ¥æ‰¾å˜é‡æ—¶ï¼Œä¼šå…ˆä»å½“å‰ä¸Šä¸‹æ–‡çš„å˜é‡å¯¹è±¡ä¸­æŸ¥æ‰¾ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œå°±ä¼šä»è¯æ³•å±‚é¢çš„çˆ¶çº§æ‰§è¡Œä¸Šä¸‹æ–‡çš„å˜é‡å¯¹è±¡ä¸­æŸ¥æ‰¾ï¼Œç›´åˆ°å…¨å±€ä¸Šä¸‹æ–‡çš„å˜é‡å¯¹è±¡ã€‚è¿™æ ·ç”±å¤šä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡çš„å˜é‡å¯¹è±¡æ„æˆçš„é“¾è¡¨å°±æ˜¯ä½œç”¨åŸŸé“¾ã€‚</p> <h2 id="é—­åŒ…"><a href="#é—­åŒ…" class="header-anchor">#</a> é—­åŒ…</h2> <p>æœ‰æƒé™è®¿é—®å…¶ä»–å…¶ä»–å‡½æ•°ä½œç”¨åŸŸä¸­å˜é‡çš„å‡½æ•°å°±å«åšé—­åŒ…ã€‚</p> <h3 id="é—­åŒ…çš„ä½œç”¨"><a href="#é—­åŒ…çš„ä½œç”¨" class="header-anchor">#</a> é—­åŒ…çš„ä½œç”¨</h3> <ul><li>å»¶é•¿å˜é‡çš„ç”Ÿå‘½å‘¨æœŸ</li> <li>å®ç° private å±æ€§</li></ul> <h2 id="this-æŒ‡å‘"><a href="#this-æŒ‡å‘" class="header-anchor">#</a> this æŒ‡å‘</h2> <ul><li>æ–¹æ³•ä¸­è°ƒç”¨ï¼šæŒ‡å‘è°ƒç”¨è€…</li> <li>æ„é€ å‡½æ•°ä¸­è°ƒç”¨ï¼šæŒ‡å‘æ–°ç”Ÿæˆçš„å¯¹è±¡</li> <li>ç®­å¤´å‡½æ•°ä¸­è°ƒç”¨ï¼šä¸æœ€è¿‘ä¸€å±‚éç®­å¤´å‡½æ•°æ‰€åœ¨ç¯å¢ƒçš„ this ä¿æŒä¸€è‡´</li> <li>call apply bind è°ƒç”¨ï¼šæŒ‡å‘æŒ‡å®šçš„ this</li></ul> <p>ç®­å¤´å‡½æ•°ä¸­çš„ this ä¸èƒ½é€šè¿‡ call apply bind ä¿®æ”¹ã€‚</p> <p>bind this è¿”å›çš„å‡½æ•°ä¸èƒ½å†é€šè¿‡ call apply bind ä¿®æ”¹ this æŒ‡å‘ã€‚</p> <h2 id="å˜é‡æå‡"><a href="#å˜é‡æå‡" class="header-anchor">#</a> å˜é‡æå‡</h2> <p>è¿›å…¥æ‰§è¡Œä¸Šä¸‹æ–‡æ—¶ï¼Œé¦–å…ˆä¼šå¤„ç†å‡½æ•°å£°æ˜ï¼Œå…¶æ¬¡ä¼šå¤„ç†å˜é‡å£°æ˜ï¼Œå‡½æ•°å£°æ˜æ¯”å˜é‡å£°æ˜ä¼˜å…ˆåº¦é«˜ã€‚</p> <h2 id="event-loop"><a href="#event-loop" class="header-anchor">#</a> event loop</h2> <p>å‡½æ•°æ‰§è¡Œæ—¶ï¼Œä¼šç”Ÿæˆè¿™ä¸ªå‡½æ•°å¯¹åº”çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œæ‰§è¡Œä¸Šä¸‹æ–‡åŒ…å«è¿™ä¸ªå‡½æ•°çš„ä½œç”¨åŸŸã€thisã€å®šä¹‰çš„å˜é‡ã€‚</p> <p>ç„¶åè¿™ä¸ªæ‰§è¡Œä¸Šä¸‹æ–‡ä¼šè¢«æ”¾å…¥æ‰§è¡Œæ ˆä¸­ï¼Œå¦‚æœç¢°åˆ°å¼‚æ­¥ä»»åŠ¡ï¼Œä¼šå°†å¼‚æ­¥ä»»åŠ¡æŒ‚èµ·ç»§ç»­æ‰§è¡Œæ‰§è¡Œæ ˆä¸­å…¶ä»–çš„ä»»åŠ¡ï¼Œç­‰åˆ°å¼‚æ­¥ä»»åŠ¡å®Œæˆï¼Œç»“æœä¼šè¢«æ”¾å…¥ä»»åŠ¡é˜Ÿåˆ—ä¸­ï¼Œç­‰åˆ°æ‰§è¡Œæ ˆä¸­çš„ä»»åŠ¡å…¨éƒ¨å®Œæˆï¼Œå°±ä¼šæŠŠä»»åŠ¡é˜Ÿåˆ—æ’åœ¨ç¬¬ä¸€çš„ä»»åŠ¡æ”¾å…¥æ‰§è¡Œæ ˆä¸­ç»§ç»­æ‰§è¡Œï¼Œè¿™å°±æ˜¯ event loopã€‚</p> <p>ä»»åŠ¡é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡åˆåˆ†ä¸ºå®ä»»åŠ¡ï¼ˆglobalã€setTimeoutã€setIntervalï¼‰ã€å¾®ä»»åŠ¡ï¼ˆPromise.thenã€MutationObserverï¼‰ã€‚</p> <p>åœ¨ä¸€æ¬¡ event loop ä¸­æ€»æ˜¯å…ˆæ‰§è¡Œä¸€ä¸ªå®ä»»åŠ¡ï¼Œç„¶åæ‰§è¡Œå…¨éƒ¨å¾®ä»»åŠ¡ï¼Œè§†å›¾é‡æ–°æ¸²æŸ“ã€‚</p> <h2 id="promise"><a href="#promise" class="header-anchor">#</a> promise</h2> <p>promise æ˜¯ä¸€ä¸ªç­‰å¾…è¢«å¼‚æ­¥æ‰§è¡Œçš„å¯¹è±¡ï¼Œå®ƒæœ‰ä¸‰ç§çŠ¶æ€ï¼ˆpending, resolved, rejectedï¼‰ï¼Œé»˜è®¤çŠ¶æ€æ˜¯ pendingï¼Œå½“å®ƒæ‰§è¡Œå®Œæˆåï¼Œå…¶çŠ¶æ€ä¼šå˜æˆ resolved æˆ–è€… rejectedï¼ŒçŠ¶æ€ä¸€æ—¦æ”¹å˜å°±ä¸èƒ½å†å˜ã€‚æ”¯æŒä½¿ç”¨ then æ–¹æ³•é“¾å¼è°ƒç”¨ï¼Œæ¯æ¬¡æ‰§è¡Œ then æ–¹æ³•åè¿”å›çš„æ˜¯ä¸€ä¸ªæ–°çš„ promise å¯¹è±¡ã€‚</p> <p>promise ä¸»è¦è§£å†³äº†å›è°ƒåœ°åŸŸçš„é—®é¢˜</p> <h3 id="promise-å¸¸è§é¢è¯•é¢˜"><a href="#promise-å¸¸è§é¢è¯•é¢˜" class="header-anchor">#</a> promise å¸¸è§é¢è¯•é¢˜</h3> <h4 id="promise-åŒæ­¥æ‰§è¡Œ"><a href="#promise-åŒæ­¥æ‰§è¡Œ" class="header-anchor">#</a> promise åŒæ­¥æ‰§è¡Œ</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// å®ç° mergePromise</span>
<span class="token comment">// æœ€åè¾“å‡º: 1, 2, 3 'done' [1, 2, 3]</span>
<span class="token keyword">const</span> <span class="token function-variable function">timeout</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">ms</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ms<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">ajax1</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token function">timeout</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">ajax2</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token function">timeout</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'2'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">ajax3</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
  <span class="token function">timeout</span><span class="token punctuation">(</span><span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'3'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token number">3</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">mergePromise</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> list <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> target<span class="token punctuation">;</span>

  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">while</span><span class="token punctuation">(</span><span class="token punctuation">(</span>target <span class="token operator">=</span> list<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> target<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">target</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      result<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//test</span>
<span class="token function">mergePromise</span><span class="token punctuation">(</span><span class="token punctuation">[</span>ajax1<span class="token punctuation">,</span> ajax2<span class="token punctuation">,</span> ajax3<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'done'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="promise-é™åˆ¶å¹¶è¡Œè¯·æ±‚ä¸ªæ•°"><a href="#promise-é™åˆ¶å¹¶è¡Œè¯·æ±‚ä¸ªæ•°" class="header-anchor">#</a> promise é™åˆ¶å¹¶è¡Œè¯·æ±‚ä¸ªæ•°</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">timeout</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">delay <span class="token operator">=</span> <span class="token number">1000</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> delay<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">const</span> <span class="token function-variable function">addTask</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">time<span class="token punctuation">,</span> order</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">timeout</span><span class="token punctuation">(</span>time<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>order<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token function-variable function">multiPromise</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">args<span class="token punctuation">,</span> nums <span class="token operator">=</span> <span class="token number">2</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> list <span class="token operator">=</span> args<span class="token punctuation">.</span><span class="token function">slice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> done <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> <span class="token function-variable function">run</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">index<span class="token punctuation">,</span> request</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      result<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> res<span class="token punctuation">;</span>
      done<span class="token operator">++</span><span class="token punctuation">;</span>

      done <span class="token operator">===</span> args<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">&amp;&amp;</span> <span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
      list<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> <span class="token function">run</span><span class="token punctuation">(</span>args<span class="token punctuation">.</span>length <span class="token operator">-</span> list<span class="token punctuation">.</span>length<span class="token punctuation">,</span> list<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> nums<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      list<span class="token punctuation">.</span>length <span class="token operator">&amp;&amp;</span> <span class="token function">run</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> list<span class="token punctuation">.</span><span class="token function">shift</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> list <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token function">addTask</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">addTask</span><span class="token punctuation">(</span><span class="token number">500</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">addTask</span><span class="token punctuation">(</span><span class="token number">300</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">addTask</span><span class="token punctuation">(</span><span class="token number">400</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre></div><h4 id="promise-å¼‚æ­¥ç›¸åŠ "><a href="#promise-å¼‚æ­¥ç›¸åŠ " class="header-anchor">#</a> promise å¼‚æ­¥ç›¸åŠ </h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">addRemote</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter">a<span class="token punctuation">,</span> b</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token parameter">resolve</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">resolve</span><span class="token punctuation">(</span>a <span class="token operator">+</span> b<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token parameter"><span class="token operator">...</span>args</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span> Promise<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token function">addRemote</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> promiseList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> args<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">+=</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    promiseList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token function">addRemote</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> args<span class="token punctuation">[</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">||</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> Promise<span class="token punctuation">.</span><span class="token function">all</span><span class="token punctuation">(</span>promiseList<span class="token punctuation">)</span>

  <span class="token keyword">return</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token operator">...</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// test</span>
<span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token function">add</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="generator"><a href="#generator" class="header-anchor">#</a> generator</h2> <p><code>generator</code> å‡½æ•°è°ƒç”¨æ—¶ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯ä¼šç”Ÿæˆä¸€ä¸ªç”Ÿæˆå™¨å¯¹è±¡ã€‚</p> <p>æ¯å½“è°ƒç”¨ç”Ÿæˆå™¨å¯¹è±¡çš„ <code>next</code> æ–¹æ³•æ—¶ï¼Œå‡½æ•°è¿è¡Œåˆ°ä¸‹ä¸€ä¸ª <code>yield</code> è¡¨è¾¾å¼ã€‚</p> <p>è¿”å›è¡¨è¾¾å¼ç»“æœå¹¶æš‚åœè‡ªèº«ï¼Œå½“æŠµè¾¾ç”Ÿæˆå™¨å‡½æ•°çš„æœ«å°¾æ—¶ï¼Œè¿”å›ç»“æœä¸­ done çš„å€¼ä¸º trueï¼Œvalue çš„å€¼ä¸º undefinedã€‚</p> <h3 id="ç®€å•ä½¿ç”¨"><a href="#ç®€å•ä½¿ç”¨" class="header-anchor">#</a> ç®€å•ä½¿ç”¨</h3> <div class="language-jsx extra-class"><pre class="language-jsx"><code><span class="token keyword">function</span><span class="token operator">*</span> <span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">yield</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token keyword">yield</span> <span class="token number">3</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">var</span> iter<span class="token operator">=</span><span class="token function">example</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//{value:1ï¼Œdone:false}</span>
iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//{value:2ï¼Œdone:false}</span>
iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//{value:3ï¼Œdone:false}</span>
iter<span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//{value:undefinedï¼Œdone:true}</span>
</code></pre></div><h3 id="es-5-ä¸­çš„å®ç°"><a href="#es-5-ä¸­çš„å®ç°" class="header-anchor">#</a> es 5 ä¸­çš„å®ç°</h3> <p><strong>ç¼–è¯‘å™¨ä¼šç”Ÿæˆä¸€ä¸ªå†…éƒ¨ç±»æ¥ä¿å­˜ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œç„¶åå°† yield return è¡¨è¾¾å¼è½¬æ¢æˆ switch caseï¼Œé€šè¿‡çŠ¶æ€æœºæ¨¡å¼å®ç° yield å…³é”®å­—çš„ç‰¹æ€§ã€‚</strong></p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">æœ€åæ›´æ–°æ—¶é—´:</span> <span class="time">6/29/2021, 2:27:11 PM</span></div></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/notebook/interview/css.html">
        css
      </a>
      â†’
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/notebook/assets/js/app.af3d77a2.js" defer></script><script src="/notebook/assets/js/2.b500958f.js" defer></script><script src="/notebook/assets/js/15.0a87671a.js" defer></script>
  </body>
</html>
